âŸ¨ValueâŸ© â† â€¢Import "value.bqn"
âŸ¨MLPâŸ© â† â€¢Import "nn.bqn"

m â† MLP 3â€¿4â€¿4â€¿1

xs â† Valueâš‡0 âŸ¨2,3,Â¯1âŸ©â€¿âŸ¨3,Â¯1,0.5âŸ©â€¿âŸ¨0.5,1,1âŸ©â€¿âŸ¨1,1,Â¯1âŸ©
ys â† ValueÂ¨ 1â€¿Â¯1â€¿Â¯1â€¿1
yp â† m.CallÂ¨ xs
loss â† @

Descent â† {ğ•¤
  yp â†© m.CallÂ¨ xs
  loss â†© { ğ•¨.Add ğ•© }Â´ yp { (ğ•¨.Sub ğ•©).Pow 2 }Â¨ ys

  { ğ•©.Gr 0 }Â¨ m.Params@
  loss.Backward@

  { ğ•©.Da (ğ•©.Data@) + Â¯0.2 Ã— ğ•©.Grad@ }Â¨ m.Params@
}

â€¢Out "ground truth:"
â€¢Show { ğ•©.Data@ }Â¨ ys
â€¢Out "initial classification:"
â€¢Show { ğ•©.Data@ }Â¨ yp
DescentâŸ20 @
â€¢Out "after training:"
â€¢Show { ğ•©.Data@ }Â¨ yp
