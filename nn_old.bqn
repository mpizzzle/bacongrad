âŸ¨ValueâŸ© â† â€¢Import "value.bqn"

Rand â† {ğ•¤
  (1 -Ëœ 2 Ã— â€¢rand.RangeâŠ¸Ã·) 1 -Ëœ 2 â‹† 32
}

Neuron â‡ {
  weights â† Valueâˆ˜RandÂ¨ â†•ğ•©
  bias â† Value Rand@

  Call â‡ {
    act â† bias { ğ•¨.Add ğ•© }Â´ weights { ğ•¨.Mul ğ•© }Â¨ ğ•©
    act.Tanh@
  }

  Params â‡ {ğ•¤
    weights âˆ¾ bias
  }
}

Layer â‡ {
  shapeâ€¿count â† ğ•©
  neurons â† NeuronâŸœshapeÂ¨ â†•count

  Call â‡ {
    (1=â‰ ) â—¶ âŠ¢â€¿âŠ‘ ğ•©âŠ¸{ ğ•©.Call ğ•¨ }Â¨ neurons
  }

  Params â‡ {ğ•¤
    âˆ¾ { ğ•©.Params@ }Â¨ neurons
  }
}

MLP â‡ {
  layers â† LayerË˜ 2 â†• ğ•©

  Call â‡ {
    ğ•© { ğ•¨.Call ğ•© }Â´ âŒ½ layers
  }

  Params â‡ {ğ•¤
    âˆ¾ { ğ•©.Params@ }Â¨ layers
  }
}
