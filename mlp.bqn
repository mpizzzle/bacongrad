âŸ¨Init, Val, Add, Mul, TanhâŸ© â† â€¢Import "value.bqn"
âŸ¨Rand, Group, Last, _lâŸ© â† â€¢Import "util.bqn"

Ranges â† Ã—Â´Ë˜ 1â€¿0 +â‰1 2âŠ¸â†•

Layer â† {
  in â† (m â† ğ•¨) Last 1 -Ëœ â‰  âŠ‘ out â† ğ•©
  weightsâ€¿biases â† in â‰ âŠ¸(âˆ¾Â¨ â†‘Â¨ â‹ˆ Â¯1âŠ¸â†‘Â¨) out

  m Mul _lâ†© weights â‰Â¨Ëœ âˆ¾ out â‰ âŠ¸/ â‹ˆ in
  m Add _lâ†© biases âˆ¾Â¨ in (âŠ£ Group m Last Ã—)â—‹â‰  out
  m Tanh _l m Last â‰ out
}

MLP â‡ { âˆ¾ Initâˆ˜RandÂ¨ â†• +Â´ Ranges ğ•© }
Address â‡ Ranges GroupÂ¨âŸœ(â†•Â¨++`âŠ¸-)Ëœ 1 + Â¯1âŠ¸â†“
_bindCall â‡ { (Val _l Layer _l ğ”½) _l }
