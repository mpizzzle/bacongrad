âŸ¨GnuplotâŸ© â† â€¢Import "Gnuplot.bqn"
âŸ¨ValueâŸ© â† â€¢Import "value.bqn"

F â† { (3 Ã— ğ•© â‹† 2) + (Â¯4 Ã— ğ•©) + 5 }

h â† 0.000001
#x â† 2 Ã· 3

#((F x + h) - F x) Ã· h

xs â† 5-Ëœ4Ã·Ëœâ†•40
ys â† F xs

#plt â† Gnuplot ""
#plt.Plot (â‰xsâ‰ys)â€¿"lw 2 lc rgb 'black'"
#plt.Show @

#a â† 2
#b â† Â¯3
#c â† 10
#d1 â† c + a Ã— b
#
##a â†© a + h
##d2 â† c + a Ã— b
##h Ã·Ëœ d2 - d1
#
#b â†© b + h
#d3 â† c + a Ã— b
#h Ã·Ëœ d3 - d1

#Value â† {
#  O â† âŠ¢
#  B â† âŠ¢
#  c â† âŸ¨âŸ©
#  d â† ğ•©
#  g â† 0
#  this â† ğ•¤
#
#  Back â‡ {
#    ğ•¤ â‹„ B@
#  }
#
#  Show â‡ {ğ•¤
#    lab â† "operation"â€¿"children"â€¿"data"â€¿"gradient"
#    â‰> lab â‹ˆ oâ€¿câ€¿dâ€¿g
#  }
#
#  Repr â‡ {
#    ğ•¤ â‹„ d
#  }
#
#  Grad â‡ {
#    ğ•¤ â‹„ g
#  }
#
#  Chil â‡ {
#    ğ•¤ â‹„ c
#  }
#
#  Oper â‡ {
#    ğ•¤ â‹„ o
#  }
#
#  Ba â‡ {
#    B â†© ğ•
#  }
#
#  Op â‡ {
#    O â†© ğ•
#  }
#
#  Ch â‡ {
#    c â†© ğ•©
#  }
#
#  Gr â‡ {
#    g â†© ğ•©
#  }
#
#  Da â‡ {
#    d â†© ğ•©
#  }
#
#  Apply â† {
#    temp â† Value ğ•Â´ ğ•©
#    temp.Op ğ•¨
#    temp.Ch thisâ‹ˆğ•©
#    temp
#  }
#
#  Tanh â‡ {ğ•¤
#    F â† â€¢math.Tanh
#    temp â† Value F d
#    temp.Op f
#    temp.Ch d
#
#    Backwards â† {ğ•¤
#      g â†© 1 - 2 â‹†Ëœ temp.Repr@
#    }
#
#    temp.Ba backwards
#    temp
#  }
#
#  Add â‡ {
#    F â† +
#
#    i â† ğ•©
#    out â† f Apply d â‹ˆ ğ•©.Repr@
#
#    Backwards â† {ğ•¤
#      i.Gr 1 Ã— out.Grad@
#      g â†© 1 Ã— out.Grad@
#    }
#
#    out.Ba backwards
#    out
#  }
#
#  Mul â‡ {
#    F â† Ã—
#
#    i â† ğ•©
#    out â† f Apply d â‹ˆ ğ•©.Repr@
#
#    Backwards â† {ğ•¤
#      i.Gr d Ã— out.Grad@
#      g â†© (i.Repr@) Ã— out.Grad@
#    }
#
#    out.Ba backwards
#    out
#  }
#}


Lol â† {ğ•¤
  h â† 0.0001
  aa â† Value 2.0
  bb â† Value Â¯3.0
  cc â† Value 10
  ee â† (aa.Mul bb)
  dd â† (ee.Add cc)
  ff â† Value Â¯2.0
  l1 â† (dd.Mul ff).Repr@

  aa â†© Value 2.0
  bb â†© Value Â¯3.0
  cc â†© Value 10
  ee â†© (aa.Mul bb)
  dd â†© (ee.Add cc)
  dd.Da h + dd.Repr@
  ff â†© Value Â¯2.0
  l2 â† (dd.Mul ff).Repr@

  (l2 - l1) Ã· h
}

Lol@

aa â† Value 2
#aa.Gr Â¯3 Ã— Â¯2
aa.Show@

bb â† Value Â¯3
#bb.Gr 2 Ã— Â¯2
bb.Show@

cc â† Value 10
#cc.Gr Â¯2 Ã— 1
cc.Show@

ee â† (aa.Mul bb)
#ee.Gr Â¯2 Ã— 1
ee.Show@

dd â† (ee.Add cc)
#dd.Gr Â¯2
dd.Show@

ff â† Value Â¯2
#ff.Gr 4
ff.Show@

l â† dd.Mul ff
l.Gr 1
l.Show@

l.Back@
ff.Show@
dd.Show@
dd.Back@
ee.Show@
cc.Show@
ee.Back@
aa.Show@
bb.Show@

#th â† â€¢math.Tanh 5 -Ëœ 5 Ã·Ëœ â†•50
#plt â† Gnuplot ""
#plt.Plot thâ€¿"lw 2 lc rgb 'black'"
#plt.Show @

x1 â† Value 2.0
#x1.Gr Â¯3.0 Ã— 0.5
x1.Show@

x2 â† Value 0.0
#x2.Gr 1.0 Ã— 0.5
x2.Show@

w1 â† Value Â¯3.0
#w1.Gr 2.0 Ã— 0.5
w1.Show@

w2 â† Value 1.0
#w2.Gr 0.0 Ã— 0.5
w2.Show@

x1w1 â† x1.Mul w1
#x1w1.Gr 0.5
x1w1.Show@

x2w2 â† x2.Mul w2
#x2w2.Gr 0.5
x2w2.Show@

x1w1x2w2 â† x1w1.Add x2w2
#x1w1x2w2.Gr 0.5
x1w1x2w2.Show@

b â† Value 6.8813735870195432
#b.Gr 0.5
b.Show@

n â† x1w1x2w2.Add b
#n.Gr 1 - 2 â‹†Ëœ (n.Tanh@).Repr@
n.Show@

o â† n.Tanh@
o.Gr 1
o.Show@
o.Back@
n.Show@
n.Back@
x1w1x2w2.Show@
b.Show@

x1w1x2w2.Back@
x1w1.Show@
x2w2.Show@
qwer â† âŠ‘ x2w2.Chil@
(Qwer@).Show@

x1w1.Back@
x2w2.Back@

x1.Show@
x2.Show@
w1.Show@
w2.Show@
